<project name="SYMBOLRT" default="compile" basedir=".">

	<!-- PROPERTIES -->

	<property name="lib.dir" value="lib" />
	<property name="bin.dir" value="bin" />
	<property name="src.dir" value="src" />
	<property name="dest.dir" value="dest" />
	<property name="prefix.zip.dir" value="SYMBOLRT" />
	<property name="pkg.dest.dir" value="br/edu/ufcg/symbolrt/compiler/parser" />
	<property name="javacc.output" value="${src.dir}/${pkg.dest.dir}" />
	<property name="grammar.file" value="etc/grammar.jj" />
	

	<!-- TASKS -->

	<target name="clean" description="Removes all source code generated by JavaCC">
		<echo>Removing old files</echo>
		<delete file="${javacc.output}/**.java" />
	</target>

	<target name="source" depends="clean" description="Generates new source code from grammar.jj">
		<javacc target="${grammar.file}" outputdirectory="${javacc.output}" javacchome="${lib.dir}" static="">
		</javacc>
	</target>

	<target name="compile" depends="source">
		<echo>Compiling source code</echo>
		<mkdir dir="${bin.dir}" />
		<javac srcdir="${src.dir}" destdir="${bin.dir}">
		</javac>
	</target>
	
	<target name="zip" description="creates a distribution zip file ">
		 <mkdir dir="${dest.dir}" />
		 <delete file="${dest.dir}/SYMBOLRT.zip" /> 
		 <zip destfile="${dest.dir}/SYMBOLRT.zip">
		    <zipfileset dir="${bin.dir}"
		    	     excludes="**/*Test.class"
		    		prefix="${prefix.zip.dir}/${bin.dir}"
		    />
		 	<zipfileset dir="${lib.dir}"
		 		includes="symbolrtdbm"
		 		prefix="${prefix.zip.dir}/${lib.dir}"
		 	/>
		 	<zipfileset dir="${basedir}"
				includes="LICENSE.txt symbolrt symbolrt.properties"
		 		prefix="${prefix.zip.dir}"
		 	/>
		 	<zipfileset dir="examples"
		 		prefix="${prefix.zip.dir}/examples"
		 	/>
		  </zip>
		
	</target>

</project>
